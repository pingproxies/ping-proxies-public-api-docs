---
title: "Create a proxy user with metadata, bandwidth limits and service restriction"
description: "Learn how to create a proxy user for your SEO with custom metadata, bandwidth limits and restricted to a specific service"
icon: "user-plus"
---

This example demonstrates how to create a proxy user specifically for your SEO department with a 10GB bandwidth limit and restricted to a single service ID. This is useful for managing and controlling access to your proxy resources within different teams or departments.

<CodeGroup>
```python Python
import requests

# API credentials
API_PUBLIC_KEY = "your_public_key"
API_PRIVATE_KEY = "your_private_key"
BASE_URL = "https://api.pingproxies.com/1.0/public"

# Headers for authentication
headers = {
    "X-API-Public-Key": API_PUBLIC_KEY,
    "X-API-Private-Key": API_PRIVATE_KEY,
    "Content-Type": "application/json"
}

def create_department_proxy_user(user_id, password, department, bandwidth_limit_bytes, service_id):
    """
    Create a proxy user for a specific department with bandwidth limits and service restriction.
    
    Args:
        user_id: ID to be used for the proxy user
        password: Password for the proxy user
        department: Department name (for metadata)
        bandwidth_limit_bytes: Residential bandwidth limit in bytes
        service_id: Service ID to restrict this proxy user to
        
    Returns:
        Created proxy user details or None if creation failed
    """
    # Convert GB to bytes (10GB = 10 * 1024 * 1024 * 1024 bytes)
    
    # Create the request payload
    payload = {
        "proxy_user_id": user_id,
        "proxy_user_password": password,
        "proxy_user_is_service_restricted": True,
        "restricted_service_ids": [service_id],
        "proxy_user_residential_bytes_limit": bandwidth_limit_bytes,
        "proxy_user_metadata": {
            "department": department,
            "created_by": "api",
            "purpose": "seo_monitoring"
        }
    }
    
    # Make request to create the proxy user
    response = requests.post(
        f"{BASE_URL}/user/proxy_user/create",
        json=payload,
        headers=headers
    )
    
    if response.status_code != 201:  # This endpoint returns 201 Created on success
        print(f"Error: {response.status_code}")
        print(response.text)
        return None
    
    data = response.json()
    print(f"Successfully created proxy user for {department} department")
    return data

# Example usage
if __name__ == "__main__":
    # Define parameters
    DEPARTMENT = "SEO"
    USER_ID = "seo_department"
    PASSWORD = "strong_password_123"
    SERVICE_ID = "API-1234-5678"  # Replace with your actual service ID
    
    # Convert 10GB to bytes
    BANDWIDTH_LIMIT_GB = 10
    BANDWIDTH_LIMIT_BYTES = BANDWIDTH_LIMIT_GB * 1024 * 1024 * 1024
    
    # Create the proxy user
    result = create_department_proxy_user(
        user_id=USER_ID,
        password=PASSWORD,
        department=DEPARTMENT,
        bandwidth_limit_bytes=BANDWIDTH_LIMIT_BYTES,
        service_id=SERVICE_ID
    )
    
    if result:
        print("Proxy User Details:")
        print(f"  ID: {result['data']['proxy_user_id']}")
        print(f"  Password: {result['data']['proxy_user_password']}")
        print(f"  Service Restricted: Yes, to service {SERVICE_ID}")
        print(f"  Bandwidth Limit: {BANDWIDTH_LIMIT_GB}GB")
```

```javascript JavaScript
// API credentials
const API_PUBLIC_KEY = 'your_public_key';
const API_PRIVATE_KEY = 'your_private_key';
const BASE_URL = 'https://api.pingproxies.com/1.0/public';

/**
 * Create a proxy user for a specific department with bandwidth limits and service restriction
 * @param {Object} options - Proxy user options
 * @returns {Promise<Object>} Created proxy user details
 */
async function createDepartmentProxyUser(options) {
  const {
    userId,
    password,
    department,
    bandwidthLimitBytes,
    serviceId
  } = options;
  
  // Create the request payload
  const payload = {
    proxy_user_id: userId,
    proxy_user_password: password,
    proxy_user_is_service_restricted: true,
    restricted_service_ids: [serviceId],
    proxy_user_residential_bytes_limit: bandwidthLimitBytes,
    proxy_user_metadata: {
      department: department,
      created_by: 'api',
      purpose: 'seo_monitoring'
    }
  };
  
  try {
    const response = await fetch(`${BASE_URL}/user/proxy_user/create`, {
      method: 'POST',
      headers: {
        'X-API-Public-Key': API_PUBLIC_KEY,
        'X-API-Private-Key': API_PRIVATE_KEY,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    });
    
    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`HTTP error! Status: ${response.status}, Details: ${errorText}`);
    }
    
    const data = await response.json();
    console.log(`Successfully created proxy user for ${department} department`);
    return data;
    
  } catch (error) {
    console.error('Error creating proxy user:', error);
    return null;
  }
}

// Example usage
async function main() {
  // Define parameters
  const DEPARTMENT = 'SEO';
  const USER_ID = 'seo_department';
  const PASSWORD = 'strong_password_123';
  const SERVICE_ID = 'API-1234-5678';  // Replace with your actual service ID
  
  // Convert 10GB to bytes
  const BANDWIDTH_LIMIT_GB = 10;
  const BANDWIDTH_LIMIT_BYTES = BANDWIDTH_LIMIT_GB * 1024 * 1024 * 1024;
  
  // Create the proxy user
  const result = await createDepartmentProxyUser({
    userId: USER_ID,
    password: PASSWORD,
    department: DEPARTMENT,
    bandwidthLimitBytes: BANDWIDTH_LIMIT_BYTES,
    serviceId: SERVICE_ID
  });
  
  if (result) {
    console.log('Proxy User Details:');
    console.log(`  ID: ${result.data.proxy_user_id}`);
    console.log(`  Password: ${result.data.proxy_user_password}`);
    console.log(`  Service Restricted: Yes, to service ${SERVICE_ID}`);
    console.log(`  Bandwidth Limit: ${BANDWIDTH_LIMIT_GB}GB`);
  }
}

main().catch(console.error);
```

```php PHP
<?php
// API credentials
$apiPublicKey = 'your_public_key';
$apiPrivateKey = 'your_private_key';
$baseUrl = 'https://api.pingproxies.com/1.0/public';

/**
 * Create a proxy user for a specific department with bandwidth limits and service restriction
 * 
 * @param string $userId ID to be used for the proxy user
 * @param string $password Password for the proxy user
 * @param string $department Department name (for metadata)
 * @param int $bandwidthLimitBytes Residential bandwidth limit in bytes
 * @param string $serviceId Service ID to restrict this proxy user to
 * @return array|null Created proxy user details or null if creation failed
 */
function createDepartmentProxyUser($apiPublicKey, $apiPrivateKey, $baseUrl, $userId, $password, $department, $bandwidthLimitBytes, $serviceId) {
    // Headers for authentication
    $headers = [
        'X-API-Public-Key: ' . $apiPublicKey,
        'X-API-Private-Key: ' . $apiPrivateKey,
        'Content-Type: application/json'
    ];
    
    // Create the request payload
    $payload = [
        'proxy_user_id' => $userId,
        'proxy_user_password' => $password,
        'proxy_user_is_service_restricted' => true,
        'restricted_service_ids' => [$serviceId],
        'proxy_user_residential_bytes_limit' => $bandwidthLimitBytes,
        'proxy_user_metadata' => [
            'department' => $department,
            'created_by' => 'api',
            'purpose' => 'seo_monitoring'
        ]
    ];
    
    // Make request to create the proxy user
    $ch = curl_init($baseUrl . '/user/proxy_user/create');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    if ($httpCode !== 201) {  // This endpoint returns 201 Created on success
        echo "Error: " . $httpCode . "\n";
        echo $response . "\n";
        return null;
    }
    
    $data = json_decode($response, true);
    echo "Successfully created proxy user for {$department} department\n";
    return $data;
}

// Example usage
// Define parameters
$department = 'SEO';
$userId = 'seo_department';
$password = 'strong_password_123';
$serviceId = 'API-1234-5678';  // Replace with your actual service ID

// Convert 10GB to bytes
$bandwidthLimitGb = 10;
$bandwidthLimitBytes = $bandwidthLimitGb * 1024 * 1024 * 1024;

// Create the proxy user
$result = createDepartmentProxyUser(
    $apiPublicKey,
    $apiPrivateKey,
    $baseUrl,
    $userId,
    $password,
    $department,
    $bandwidthLimitBytes,
    $serviceId
);

if ($result) {
    echo "Proxy User Details:\n";
    echo "  ID: " . $result['data']['proxy_user_id'] . "\n";
    echo "  Password: " . $result['data']['proxy_user_password'] . "\n";
    echo "  Service Restricted: Yes, to service {$serviceId}\n";
    echo "  Bandwidth Limit: {$bandwidthLimitGb}GB\n";
}
?>
```

```go Go
package main

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io/ioutil"
	"net/http"
)

// API credentials
const (
	apiPublicKey  = "your_public_key"
	apiPrivateKey = "your_private_key"
	baseURL       = "https://api.pingproxies.com/1.0/public"
)

// CreateProxyUserResponse represents the API response structure
type CreateProxyUserResponse struct {
	Created []string    `json:"created"`
	Data    ProxyUser   `json:"data"`
	Message string      `json:"message"`
}

// ProxyUser represents the proxy user data returned by the API
type ProxyUser struct {
	ProxyUserID       string `json:"proxy_user_id"`
	ProxyUserPassword string `json:"proxy_user_password"`
}

// ProxyUserMetadata represents the metadata for the proxy user
type ProxyUserMetadata struct {
	Department string `json:"department"`
	CreatedBy  string `json:"created_by"`
	Purpose    string `json:"purpose"`
}

// CreateProxyUserRequest represents the request payload
type CreateProxyUserRequest struct {
	ProxyUserID                 string            `json:"proxy_user_id"`
	ProxyUserPassword           string            `json:"proxy_user_password"`
	ProxyUserIsServiceRestricted bool              `json:"proxy_user_is_service_restricted"`
	RestrictedServiceIDs        []string          `json:"restricted_service_ids"`
	ProxyUserResidentialBytesLimit int64             `json:"proxy_user_residential_bytes_limit"`
	ProxyUserMetadata           ProxyUserMetadata `json:"proxy_user_metadata"`
}

// CreateDepartmentProxyUser creates a proxy user for a specific department with bandwidth limits and service restriction
func CreateDepartmentProxyUser(userID, password, department string, bandwidthLimitBytes int64, serviceID string) (*CreateProxyUserResponse, error) {
	// Create the request payload
	payload := CreateProxyUserRequest{
		ProxyUserID:                 userID,
		ProxyUserPassword:           password,
		ProxyUserIsServiceRestricted: true,
		RestrictedServiceIDs:        []string{serviceID},
		ProxyUserResidentialBytesLimit: bandwidthLimitBytes,
		ProxyUserMetadata: ProxyUserMetadata{
			Department: department,
			CreatedBy:  "api",
			Purpose:    "seo_monitoring",
		},
	}
	
	// Convert payload to JSON
	payloadBytes, err := json.Marshal(payload)
	if err != nil {
		return nil, err
	}
	
	// Create a new request
	req, err := http.NewRequest("POST", baseURL+"/user/proxy_user/create", bytes.NewBuffer(payloadBytes))
	if err != nil {
		return nil, err
	}
	
	// Add headers
	req.Header.Add("X-API-Public-Key", apiPublicKey)
	req.Header.Add("X-API-Private-Key", apiPrivateKey)
	req.Header.Add("Content-Type", "application/json")
	
	// Execute the request
	client := &http.Client{}
	resp, err := client.Do(req)
	if err != nil {
		return nil, err
	}
	defer resp.Body.Close()
	
	// Check response code
	if resp.StatusCode != 201 {  // This endpoint returns 201 Created on success
		bodyBytes, _ := ioutil.ReadAll(resp.Body)
		return nil, fmt.Errorf("API error: %d, details: %s", resp.StatusCode, string(bodyBytes))
	}
	
	// Parse the response
	body, err := ioutil.ReadAll(resp.Body)
	if err != nil {
		return nil, err
	}
	
	var createResponse CreateProxyUserResponse
	err = json.Unmarshal(body, &createResponse)
	if err != nil {
		return nil, err
	}
	
	fmt.Printf("Successfully created proxy user for %s department\n", department)
	return &createResponse, nil
}

func main() {
	// Define parameters
	department := "SEO"
	userID := "seo_department"
	password := "strong_password_123"
	serviceID := "API-1234-5678"  // Replace with your actual service ID
	
	// Convert 10GB to bytes
	bandwidthLimitGB := int64(10)
	bandwidthLimitBytes := bandwidthLimitGB * 1024 * 1024 * 1024
	
	// Create the proxy user
	result, err := CreateDepartmentProxyUser(userID, password, department, bandwidthLimitBytes, serviceID)
	if err != nil {
		fmt.Printf("Error creating proxy user: %v\n", err)
		return
	}
	
	if result != nil {
		fmt.Println("Proxy User Details:")
		fmt.Printf("  ID: %s\n", result.Data.ProxyUserID)
		fmt.Printf("  Password: %s\n", result.Data.ProxyUserPassword)
		fmt.Printf("  Service Restricted: Yes, to service %s\n", serviceID)
		fmt.Printf("  Bandwidth Limit: %dGB\n", bandwidthLimitGB)
	}
}
```

```java Java
import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.ObjectMapper;

public class CreateDepartmentProxyUser {
    
    // API credentials
    private static final String API_PUBLIC_KEY = "your_public_key";
    private static final String API_PRIVATE_KEY = "your_private_key";
    private static final String BASE_URL = "https://api.pingproxies.com/1.0/public";
    
    private static final HttpClient client = HttpClient.newHttpClient();
    private static final ObjectMapper mapper = new ObjectMapper();
    
    // Response classes
    static class CreateProxyUserResponse {
        public List<String> created;
        public ProxyUserData data;
        public String message;
    }
    
    static class ProxyUserData {
        @JsonProperty("proxy_user_id")
        public String proxyUserId;
        
        @JsonProperty("proxy_user_password")
        public String proxyUserPassword;
    }
    
    /**
     * Create a proxy user for a specific department with bandwidth limits and service restriction
     * @param userId ID to be used for the proxy user
     * @param password Password for the proxy user
     * @param department Department name (for metadata)
     * @param bandwidthLimitBytes Residential bandwidth limit in bytes
     * @param serviceId Service ID to restrict this proxy user to
     * @return Created proxy user details
     */
    public static CreateProxyUserResponse createDepartmentProxyUser(
            String userId, String password, String department, 
            long bandwidthLimitBytes, String serviceId) throws IOException, InterruptedException {
        
        // Create the request payload
        Map<String, Object> payload = new HashMap<>();
        payload.put("proxy_user_id", userId);
        payload.put("proxy_user_password", password);
        payload.put("proxy_user_is_service_restricted", true);
        payload.put("restricted_service_ids", List.of(serviceId));
        payload.put("proxy_user_residential_bytes_limit", bandwidthLimitBytes);
        
        Map<String, String> metadata = new HashMap<>();
        metadata.put("department", department);
        metadata.put("created_by", "api");
        metadata.put("purpose", "seo_monitoring");
        payload.put("proxy_user_metadata", metadata);
        
        // Convert payload to JSON
        String jsonPayload = mapper.writeValueAsString(payload);
        
        // Create the request
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(BASE_URL + "/user/proxy_user/create"))
                .header("X-API-Public-Key", API_PUBLIC_KEY)
                .header("X-API-Private-Key", API_PRIVATE_KEY)
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(jsonPayload))
                .build();
        
        // Execute the request
        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
        
        if (response.statusCode() != 201) {  // This endpoint returns 201 Created on success
            throw new IOException("API request failed with status code: " + response.statusCode() + 
                                 ", details: " + response.body());
        }
        
        // Parse the response
        CreateProxyUserResponse createResponse = mapper.readValue(response.body(), CreateProxyUserResponse.class);
        
        System.out.printf("Successfully created proxy user for %s department%n", department);
        return createResponse;
    }
    
    public static void main(String[] args) {
        try {
            // Define parameters
            String department = "SEO";
            String userId = "seo_department";
            String password = "strong_password_123";
            String serviceId = "API-1234-5678";  // Replace with your actual service ID
            
            // Convert 10GB to bytes
            long bandwidthLimitGB = 10;
            long bandwidthLimitBytes = bandwidthLimitGB * 1024 * 1024 * 1024;
            
            // Create the proxy user
            CreateProxyUserResponse result = createDepartmentProxyUser(
                userId, password, department, bandwidthLimitBytes, serviceId);
            
            if (result != null) {
                System.out.println("Proxy User Details:");
                System.out.printf("  ID: %s%n", result.data.proxyUserId);
                System.out.printf("  Password: %s%n", result.data.proxyUserPassword);
                System.out.printf("  Service Restricted: Yes, to service %s%n", serviceId);
                System.out.printf("  Bandwidth Limit: %dGB%n", bandwidthLimitGB);
            }
        } catch (Exception e) {
            System.out.println("Error creating proxy user: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
```
</CodeGroup>

## Key Features Explained

### 1. Department-Specific Metadata

Adding department information to the proxy user's metadata helps with organization and makes it easier to track usage and manage resources by department:

```json
"proxy_user_metadata": {
  "department": "SEO",
  "created_by": "api",
  "purpose": "seo_monitoring"
}
```

### 2. 10GB Bandwidth Limit

The example sets a 10GB bandwidth limit for residential proxy usage:

```
10GB = 10 * 1024 * 1024 * 1024 bytes = 10,737,418,240 bytes
```

This limit is applied through the `proxy_user_residential_bytes_limit` parameter.

### 3. Service Restriction

By setting `proxy_user_is_service_restricted` to `true` and providing the specific service ID in `restricted_service_ids`, you ensure that this proxy user can only access proxies from the designated service:

```json
"proxy_user_is_service_restricted": true,
"restricted_service_ids": ["API-1234-5678"]
```

## Benefits of Department-Specific Proxy Users

1. **Resource Allocation**: Assign appropriate bandwidth limits to each department based on their needs
2. **Access Control**: Restrict departments to specific proxy services for better security
3. **Usage Tracking**: Monitor proxy usage by department for better resource planning
4. **Cost Attribution**: Track proxy costs by department for internal billing

## Best Practices

1. **Strong Passwords**: Use strong, unique passwords for each department's proxy user
2. **Regular Review**: Periodically review bandwidth limits and adjust as needed
3. **Documentation**: Keep a record of which departments have access to which services
4. **Monitoring**: Set up alerts for departments approaching their bandwidth limits